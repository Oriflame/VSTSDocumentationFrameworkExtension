<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Add template</title>
    <script src="sdk/node_modules/vss-web-extension-sdk/lib/VSS.SDK.min.js"></script>
    <script>
        const fieldValues = [
            {
                // Description
                fieldName: 'System.Description',
                value: '<div><span style="font-weight:bold;">Scope:</span></div><div><ul style="margin-top:0in;"><li>In Scope:<br>- Item 1.<br>- Item 2.</li></ul><div><ul style="margin-top:0in;"><li>Out of Scope:<br>- Item 1<br>- Item 2</li></ul><div><b>Assumptions, Pre-requisites&nbsp;and&nbsp;Limitations</b></div></div><div><ul><li>Item 1</li><li>Item 2</li></ul></div><span style="font-weight:bold;">Requestor Name and Successful factor :</span></div><div><ul><li>Requestor Name:</li><li>Successful&nbsp;factors are:</li><ul><li>Factor 1</li><li>Factor 2</li></ul></ul><div><div><b>List of Stakeholders and&nbsp;contacts</b>:</div><div><ul><li>Name, Contact, Phone, TimeZone, Special comments</li><li>Name, Contact, Phone, TimeZone, Special comments</li></ul><div><div><b>Wish launch date</b>:</div><div><ul><li>Date, Who requested, Comments</li></ul><div><div><span style="font-weight:bold;"><span style="font-size:11pt;font-family:Calibri, sans-serif;">Functional vs Non-functional requirements</span>:</span></div><div><ul><li>Item 1</li><li>Item 2</li></ul></div></div></div></div></div></div><div><b>References</b>:</div><div><ul><li>Item 1</li><li>Item 2</li></ul></div></div>'
            },
            // not used for now
            // {
            //     //Risk section
            //     fieldName: 'Custom.RiskArea', //TODO: once the field will be created this need to be changed
            //     value: '<div style="direction:ltr;"><table border=1 cellpadding=0 cellspacing=0 title="" summary="" style="direction:ltr;border-collapse:collapse;border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1437in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><span style="font-weight:bold;">Risk Name</span></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:0.8111in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><span style="font-weight:bold;">Type</span></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:0.7979in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><span style="font-weight:bold;">Probability</span></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1152in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><span style="font-weight:bold;">Mitigation Plan</span></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:1.4381in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><span style="font-weight:bold;">Decision</span></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:2.8784in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;">Comments</p></td></tr><tr><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1437in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><b>Risk Title</b></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:0.7263in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;">Risk&nbsp;</p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:0.8826in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;text-align:right;">80%</p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1152in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;"><span style="color:black;">Short term:&nbsp; Action 1</span></p><p style="margin:0in;font-family:Calibri;font-size:11pt;">&nbsp;Long term<span style="font-size:11pt;">: Action 2</span></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:1.4381in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;"><span style="font-weight:bold;">Decision</span></p><p style="margin:0in;font-family:Calibri;font-size:11pt;"><span style="font-weight:bold;">&nbsp;</span></p><p style="margin:0in;font-family:Calibri;font-size:11pt;">&nbsp;</p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.277in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;color:black;"><span style="font-weight:bold;">Situation:</span></p><p style="margin:0in;font-family:Calibri;font-size:11pt;"><br></p></td></tr><tr><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1437in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;"><b>Opportunity&nbsp;Title</b></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:0.8305in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;">Opportunity</p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:0.8826in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;text-align:right;">50%</p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1152in;padding:4pt;"><p style="margin:0in;font-family:Calibri;font-size:11pt;"><br></p></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:1.4381in;padding:4pt;"></td><td style="border-style:solid;border-color:rgb(163, 163, 163);border-width:1pt;vertical-align:top;width:3.1756in;padding:4pt;"><b>Situation</b></td></tr></tbody></table>'
            // },
            // {
            //     //Todo section
            //     fieldName: 'Custom.TodoArea',  //TODO: once the field will be created this need to be changed
            //     value: '<div><b>TODO</b>:</div><div><ul><li>Name1: Action1 - Deadline</li><li>Name2: Action2&nbsp; - Deadline</li></ul></div>'
            // }
        ];

        VSS.init({
            explicitNotifyLoaded: true,
            usePlatformScripts: true
        });

        VSS.require(["TFS/WorkItemTracking/Services"], (_WorkItemServices) => {
            // Get the WorkItemFormService.  This service allows you to get/set fields/links on the 'active' work item (the work item
            // that currently is displayed in the UI).
            const getWorkItemFormService = () => {
                return _WorkItemServices.WorkItemFormService.getService();
            }

            VSS.register(VSS.getContribution().id, () => ({
                // This is a callback that gets invoked when a user clicks the newly contributed menu item
                // The actionContext parameter contains context data surrounding the circumstances of this
                // action getting invoked.
                execute: async (actionContext) => {
                    const service = await getWorkItemFormService();

                    // Gets and sets value for each field
                    for (let item of fieldValues) {
                        const value = await service.getFieldValues([item.fieldName]);
                        var oldValue = value[item.fieldName];
                        var newValue = item.value + oldValue;
                        await service.setFieldValue(item.fieldName, newValue);
                    };
                }
            }));

            VSS.notifyLoadSucceeded();
        });
    </script>
</head>

<body>
</body>

</html>