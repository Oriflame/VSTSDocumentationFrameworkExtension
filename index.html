<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Add template</title>
    <script src="sdk/node_modules/vss-web-extension-sdk/lib/VSS.SDK.min.js"></script>
    <script>
        var template = '<div><span style="font-weight:bold;">Scope:</span></div><div><ul style="margin-top:0in;"><li>In Scope:<br>- Item 1.<br>- Item 2.</li></ul><div><ul style="margin-top:0in;"><li>Out of Scope:<br>- Item 1<br>- Item 2</li></ul><div><b>Assumptions, Pre-requisites&nbsp;and&nbsp;Limitations</b></div></div><div><ul><li>Item 1</li><li>Item 2</li></ul></div><span style="font-weight:bold;">Requestor Name and Successful factor :</span></div><div><ul><li>Requestor Name:</li><li>Successful&nbsp;factors are:</li><ul><li>Factor 1</li><li>Factor 2</li></ul></ul><div><div><b>List of Stakeholders and&nbsp;contacts</b>:</div><div><ul><li>Name, Contact, Phone, TimeZone, Special comments</li><li>Name, Contact, Phone, TimeZone, Special comments</li></ul><div><div><b>Wish launch date</b>:</div><div><ul><li>Date, Who requested, Comments</li></ul><div><div><span style="font-weight:bold;"><span style="font-size:11pt;font-family:Calibri, sans-serif;">Functional vs Non-functional requirements</span>:</span></div><div><ul><li>Item 1</li><li>Item 2</li></ul></div></div></div></div></div></div><div><b>References</b>:</div><div><ul><li>Item 1</li><li>Item 2</li></ul></div></div>';
        var descriptionFieldName = "System.Description";

        VSS.init({
            explicitNotifyLoaded: true,
            usePlatformScripts: true
        });

        VSS.require(["TFS/WorkItemTracking/Services"], function (_WorkItemServices) {
            // Get the WorkItemFormService.  This service allows you to get/set fields/links on the 'active' work item (the work item
            // that currently is displayed in the UI).
            function getWorkItemFormService() {
                return _WorkItemServices.WorkItemFormService.getService();
            }

            VSS.register(VSS.getContribution().id, function () {
                return {
                    // This is a callback that gets invoked when a user clicks the newly contributed menu item
                    // The actionContext parameter contains context data surrounding the circumstances of this
                    // action getting invoked.
                    execute: function (actionContext) {
                        getWorkItemFormService().then(function (service) {
                            // Get the current values for a few of the common fields
                            service.getFieldValues([descriptionFieldName]).then(
                                function (value) {
                                    var oldValue = value[descriptionFieldName];
                                    var newValue = template + oldValue;
                                    service.setFieldValue(descriptionFieldName, newValue);
                                },
                                function (error) {
                                    window.alert(error.message);
                                });
                        });
                    }
                }
            });

            VSS.notifyLoadSucceeded();
        });
    </script>
</head>

<body>
</body>

</html>